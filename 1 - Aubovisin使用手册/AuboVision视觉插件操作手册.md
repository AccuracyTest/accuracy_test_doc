

# AuboVision视觉系统操作手册v1.0

## 1. 操作界面说明

### 1.1 AuboVision插件路径

AuboVision视觉系统以插件形式部署于示教器软件AUBOPE中，AuboVision插件路径为：扩展 -> Peripheral -> AuboVision。

插件中包含五个选项卡：

1. 定位： 选择视觉定位方式、制作模板
2. 路点编辑： 编辑示教点位、生成视觉脚本
3. 标定：编辑手眼标定路点、计算手眼标定结果
4. 示教：控制机械臂运动
5. 配置：调整相机参数

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision路径.png" style="zoom:50%;" />

AuboVision插件的使用权限与机器人硬件绑定，在第一次使用前需在注册界面输入对应的验证码。

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision注册界面.png" style="zoom:50%;" />

### 1.2 “定位”选项卡

AuboVision插件定位选项卡主要功能包括：

* 视觉定位类型选择：

  - 模板定位（2D）

    由用户自定义ROI以及识别对象，如工件，指定marker等

    <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\模板匹配.png" style="zoom:36%;" />

  - 特征码定位（2.5D）

    对指定特征码进行识别，不要求且不建议将相机光轴垂直于特征码所在平面拍摄。

    <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\特征码标定板.png" style="zoom:5%;" />

* 模板定位参数配置： 特征点数量，匹配阈值

* 特征码定位参数配置：循环周期， 目标精度

* 2D标定：仅在使用模板定位时使用。在相机调平后，通过识别标定板计算像素距离，用于后续模板匹配算法使用。

* 模板名字：用户可自定义模板名称。若不输入名称，模板名称将通过uuid随机生成。

* 模板列表：选择以制作的模板

* 添加模板：制作模板并添加至模板列表中

* 保存参数：将模板、参数保存至本地。模板保存后即可通过开环验证或闭环验证调用。

* 开环验证：根据选择的算法类型以及模板进行视觉算法开环验证

* 闭环验证：根据选择的算法类型以及模板进行视觉算法闭环验证

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision定位3.png" style="zoom:36%;" />

### 1.3 "路点编辑"选项卡

AuboVision插件路点编辑选项卡主要功能包括：

* 添加路点：添加需要视觉补偿的示教点位。
* 运动到路点：机械臂运动至路点列表中用户所选路点。
* 删除路点：移除路点列表中用户所选路点。
* 生成脚本：根据用户在界面中选择的定位类型、模板名称、视觉验证类型、示教点位运动类型、示教点位自动生成视觉脚本。

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision路点编辑2.png" style="zoom:36%;" />

### 1.4 “标定”选项卡

AuboVison插件标定选项卡主要功能包括：

* 添加姿态：触发相机拍照对如下图所示标定板进行识别。若成功识别标定板，下方文本框中将提示识别成功，将机械臂当前姿态记录为有效标定姿态并添加至标定路点列表中。若识别失败，则会在下方文本框中提示识别失败，需要重新调整姿态。

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\圆点标定板.jpg" style="zoom:50%;" />

* 删除姿态：移除标定路点列表中用户所选路点。

* 保存姿态：将标定路点列表中的机械臂姿态信息保存至本地。

* 自动标定：机械臂根据用户已保存的姿态信息进行运动，尝试识别标定板，最终返回手眼标定结果。

* 计算标定结果：计算手眼标定结果，并在下方文本框中输出。

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision标定2.png" style="zoom:36%;" />

### 1.5 “示教”选项卡

AuboVision插件示教选项卡主要功能包括：

* 控制机械臂进行关节运动
* 控制机械臂在基坐标系下进行直线运动
* 控制机械臂在法兰坐标系下进行末端姿态调整

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision示教.png" style="zoom:60%;" />

### 1.6 “配置”选项卡

AuboVision插件配置选项卡主要功能包括：

* 调整白平衡
* 设置相机曝光

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\AuboVision配置.png" style="zoom:60%;" />

## 2. 手眼标定

### 2.1 手动手眼标定

1. 确定标定位置，放置标定板，调整镜头焦距、光圈，确保标定板在相机画面中清晰。

2. 在连续拍照验证选项中选择标定，点击连续拍照验证按钮开始拍照

3. 移动机械臂使标定板进入相机视野，并保证标定板上特征点全识别

<img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\标定识别.png" style="zoom:36%;" />

4. 在界面下方文本框中提示识别单图成功并且相机画面中标定板特征点被标记后，点击添加机器人姿态，等待添加成功
5. 变化机器人姿态，重复2，3，4 步骤至少15次
6. 点击保存姿态
7. 点击计算标定结果；若下方文本框提示标定结果验证成功，手眼标定完成；若下方文本框中提示标定结果验证失败，需调整机械臂标定姿态，重新计算标定结果。

### 2.2 自动手眼标定

自动标定将根据用户保存的手眼标定姿态控制机械臂进行运动，并对标定板进行识别。

	1. 点击自动标定
	1. 若已保存的手眼标定姿态小于5个，自动标定将不会开始
	1. 等待自动标定结束，查看标定结果

自动标定过程中，若在某个姿态未成功识别标定板，该姿态将被移除。用户可根据需要，重新调整手眼标定姿态。

## 3. 特征码定位

- 点击定位选项卡
- 定位类型选择特征码定位
- 设置循环周期（默认为10），设置目标精度（默认为0.5）
- 选择拍照位
  - 拍照高度：与相机镜头、环境光照、末端设备尺寸等多种因素相关。以使用12mm镜头，Φ90相机光源，末端设备长度为200mm为参考，拍摄高度通常为200mm左右。
  - 拍照角度：特征码与相机成45度左右（确保可以识别出x，y，z轴，避免相机光轴与特征码平面垂直拍摄）

* 输入特征码定位模板名称（可选）

* 点击添加模板

  * 相机画面中特征码将被标记，并显示特征码的x，y，z轴
  * 特征码中二维码的识别率越高，最终视觉引导精度越高

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\特征码模板制作.png" style="zoom:36%;" />

* 点击保存参数

* 在模板列表中选择建立的模板名称，点击开环或闭环验证，检验特征码定位模板是否制作成功

* 验证成功后，点击路点编辑选项卡

* 定位类型选择特征码定位

* 模板列表选择建立的模板名称

* 进行机械臂点位示教，在插件界面选择需要的运动类型，点击添加路点

* 完成所有路点添加后，选择视觉验证类型，默认为开环验证

* 点击生成脚本

  * 特征码定位脚本名称为：hmakescript+特征码定位模板名称

## 4. 模板定位

- 点击定位选项卡

- 定位类型选择模板定位

- 设置特征点数量（默认为256），设置匹配阈值（默认为90）

- 在目标模板所在平面进行2D标定

  - 在连续拍照验证选项中选择调平选项
  - 点击连续拍照验证按钮，对标定板进行调平验证
  - 手动调整机械臂姿态，使相机光轴垂直于目标模板所在平面
  - 若调平完成，相机画面中标定板将被绿色方框围起；若调平未完成，相机画面中标定板将被红色方框围起

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\调平.png" style="zoom:36%;" />

  - 调平完成后，关闭连续拍照，点击2D标定
  - 等待标定完成，下方文本框显示像素距离

* 将目标模板移入相机视野，连续拍照验证选项选择默认选项，触发拍照

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\定位界面.jpg" style="zoom:12%;" />

* 在相机图像中手动拖拽图形ROI，框选模板范围

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\自定义ROI.jpg" style="zoom:12%;" />

* 输入模板定位模板名称（可选）

* 点击添加模板，等待模板制作完成

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\模板制作.jpg" style="zoom:12%;" />

* 点击保存参数

* 在模板列表选择建立的模板名称，点击开环或闭环验证，检验模板定位模板是否制作成功

  <img src="D:\AuBo\标品 - 视觉机器人标品\文档 - AuboVision视觉插件使用手册\Figs\模板匹配.jpg" style="zoom:12%;" />

* 验证成功后，点击路点编辑选项卡

* 定位类型选择模板定位

* 模板列表选择建立的模板名称

* 进行机械臂点位示教，在插件界面选择需要的运动类型，点击添加路点

* 完成所有路点添加后，选择视觉验证类型，默认为开环验证

* 点击生成脚本

  * 模板定位脚本名称为：rmakescript+模板定位模板名称